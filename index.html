<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>英単語クイズ（自動翻訳つき）</title>
<style>
body { font-family: sans-serif; max-width: 900px; margin: auto; }
section { border: 1px solid #ccc; padding: 10px; margin-bottom: 20px; }
input, button, select { margin: 4px; }
.choice button { display: block; width: 100%; margin: 4px 0; }
.history span { margin-right: 3px; }
</style>
</head>
<body>

<h1>英単語クイズ</h1>

<section>
<h2>① ボックス作成</h2>
<input id="newBoxName" placeholder="ボックス名">
<button onclick="addBox()">追加</button>
</section>

<section>
<h2>② 単語登録（英語のみ入力）</h2>
<select id="boxSelect"></select><br>
英単語：<input id="newWord">
<button onclick="addWord()">登録（自動翻訳）</button>
<span id="translating"></span>
</section>

<section>
<h2>③ 出題範囲選択</h2>
<div id="boxChecks"></div>
<button onclick="startQuiz()">クイズ開始</button>
</section>

<section>
<h2>④ 単語一覧・意味修正・履歴</h2>
<button onclick="showWordList()">一覧を表示</button>
<div id="wordList"></div>
</section>

<section>
<h2>⑤ クイズ</h2>
<h3 id="question"></h3>
<div class="choice" id="choices"></div>
<p id="result"></p>
</section>

<script>
// ===== データ =====
let data = JSON.parse(localStorage.getItem("wordData")) || {};

function save() {
  localStorage.setItem("wordData", JSON.stringify(data));
}

// ===== 翻訳 =====
async function translate(word) {
  const res = await fetch(
    `https://api.mymemory.translated.net/get?q=${word}&langpair=en|ja`
  );
  const json = await res.json();
  return json.responseData.translatedText;
}

// ===== ボックス =====
function addBox() {
  const name = newBoxName.value.trim();
  if (!name || data[name]) return;
  data[name] = {};
  save();
  updateUI();
  newBoxName.value = "";
}

function updateUI() {
  boxSelect.innerHTML = "";
  boxChecks.innerHTML = "";
  for (let b in data) {
    boxSelect.innerHTML += `<option>${b}</option>`;
    boxChecks.innerHTML +=
      `<label><input type="checkbox" value="${b}">${b}</label><br>`;
  }
}
updateUI();

// ===== 単語登録（自動翻訳） =====
async function addWord() {
  const box = boxSelect.value;
  const word = newWord.value.trim();
  if (!box || !word) return;

  translating.textC
